{"version":3,"sources":["../server/server-cluster.js"],"names":["cluster","require","workers","process","env","LEANCLOUD_AVAILABLE_CPUS","isMaster","i","fork","on","worker","code","signal","console","log","pid"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;;AAEA;AACA,IAAIC,UAAUC,QAAQC,GAAR,CAAYC,wBAAZ,IAAwC,CAAtD;;AAEA,IAAIL,QAAQM,QAAZ,EAAsB;AACpB,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIL,OAApB,EAA6BK,GAA7B,EAAkC;AAChCP,YAAQQ,IAAR;AACD;;AAEDR,UAAQS,EAAR,CAAW,MAAX,EAAmB,CAACC,MAAD,EAASC,IAAT,EAAeC,MAAf,KAA0B;AAC3CC,YAAQC,GAAR,CAAY,+BAAZ,EAA6CJ,OAAOP,OAAP,CAAeY,GAA5D;AACAf,YAAQQ,IAAR;AACD,GAHD;AAID,CATD,MASO;AACLP,UAAQ,aAAR;AACD","file":"server-cluster.js","sourcesContent":["var cluster = require('cluster');\r\n\r\n// 进程数量建议设置为可用的 CPU 数量\r\nvar workers = process.env.LEANCLOUD_AVAILABLE_CPUS || 1;\r\n\r\nif (cluster.isMaster) {\r\n  for (var i = 0; i < workers; i++) {\r\n    cluster.fork();\r\n  }\r\n\r\n  cluster.on('exit', (worker, code, signal) => {\r\n    console.log('worker %s died, restarting...', worker.process.pid);\r\n    cluster.fork();\r\n  });\r\n} else {\r\n  require('./server.js');\r\n}\r\n"]}