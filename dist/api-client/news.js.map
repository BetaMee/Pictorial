{"version":3,"sources":["../../server/api-client/news.js"],"names":["router","Router","queryHeadline","Query","get","req","res","next","data","src","alt","title","tags","link","setTimeout","json","news","message","success","count","index","isEnd","cql","doCloudQuery","then","query","results","response","i","length","push","objectId","id","pageLink","pageTitle","category","imgUrl","catch","err"],"mappings":"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","file":"news.js","sourcesContent":["import express from 'express';\r\nimport AV from 'leanengine';\r\n\r\n\r\nconst router = express.Router();\r\n// 查询头条信息\r\nconst queryHeadline = AV.Query('Headline');\r\n\r\n// GET /apiclient/news 获取新闻信息\r\nrouter.get('/', (req, res, next) => {\r\n  let data = [{\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '如何做一个会开车的老司机？',\r\n    tags: '美人志',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://img.ltn.com.tw/Upload/ent/page/800/2016/12/28/1930249_1.jpg',\r\n    alt: '',\r\n    title: '如何做一个会开车的老司机？',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n    tags: '男神志',\r\n  },\r\n  {\r\n    src: 'http://img07.tooopen.com/images/20170630/tooopen_sy_215145383452.jpg',\r\n    alt: '',\r\n    title: '如何做一个会开车的老司机？',\r\n    tags: '青年志',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '这样的「青春」一点都不吸引人',\r\n    tags: '美食志',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '没有室友的暑假，你过得还好吗?',\r\n    tags: 'have a chat',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '没有室友的暑假，你过得还好吗?',\r\n    tags: 'have a chat',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '没有室友的暑假，你过得还好吗?',\r\n    tags: 'have a chat',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '没有室友的暑假，你过得还好吗?',\r\n    tags: 'have a chat',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '没有室友的暑假，你过得还好吗?',\r\n    tags: 'have a chat',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '没有室友的暑假，你过得还好吗?',\r\n    tags: 'have a chat',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '没有室友的暑假，你过得还好吗?',\r\n    tags: 'have a chat',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n  {\r\n    src: 'http://www.fotor.com/images2/features/photo_effects/e_bw.jpg',\r\n    alt: '',\r\n    title: '没有室友的暑假，你过得还好吗?',\r\n    tags: 'have a chat',\r\n    link: 'http://mp.weixin.qq.com/s/x6gThK7UjNcWreAuKjItww',\r\n  },\r\n];\r\n  setTimeout(function() {\r\n    res.json({\r\n      news: data,\r\n      message: 'success',\r\n      success: true,\r\n      count: 5,\r\n      index: 1, // 第几次获取数据\r\n      isEnd: false, // 还有没有了\r\n    });\r\n  },0);\r\n});\r\n\r\n// GET /apiclient/news/getnews 获取新闻信息\r\nrouter.get('/getnews', (req, res, next) => {\r\n  const cql = 'select * from NewsLists';\r\n  AV.Query.doCloudQuery(cql)\r\n    .then((query) => {\r\n      const results = query.results;\r\n      const response = [];\r\n      for (let i = 0; i < results.length; i++) {\r\n        response.push({\r\n          objectId: results[i].id,\r\n          pageLink: results[i].get('pageLink'),\r\n          pageTitle: results[i].get('pageTitle'),\r\n          category: results[i].get('category'),\r\n          imgUrl: results[i].get('imgUrl'),\r\n        });\r\n      }\r\n      res.json({\r\n        success: true,\r\n        message: '发送成功',\r\n        data: response,\r\n      });\r\n    })\r\n    .catch((err) => {\r\n      res.json({\r\n        success: false,\r\n        message: err.message,\r\n      });\r\n    });\r\n});\r\n\r\n// GET /apiclient/news/getheadlines 获取Slider信息\r\nrouter.get('/getheadlines', (req, res, next) => {\r\n  const cql = 'select * from Headline';\r\n  AV.Query.doCloudQuery(cql)\r\n    .then((query) => {\r\n      const results = query.results;\r\n      const response = [];\r\n      for (let i = 0; i < results.length; i++) {\r\n        response.push({\r\n          objectId: results[i].id,\r\n          pageLink: results[i].get('pageLink'),\r\n          pageTitle: results[i].get('pageTitle'),\r\n          imgUrl: results[i].get('imgUrl'),\r\n        });\r\n      }\r\n      res.json({\r\n        success: true,\r\n        message: '发送成功',\r\n        data: response,\r\n      });\r\n    })\r\n    .catch((err) => {\r\n      res.json({\r\n        success: false,\r\n        message: err.message,\r\n      });\r\n    });\r\n});\r\n\r\nexport default router;\r\n"]}